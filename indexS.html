<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸€å¦‚åœ°è™Ÿæœå°‹</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft JhengHei', Arial, sans-serif; background: #f5f5f5; min-height: 100vh; display: flex; flex-direction: column; }
        
        /* Headeræ ·å¼ */
        .header { 
            background: white; 
            padding: 20px 40px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.05); 
            display: flex; 
            align-items: center; 
            justify-content: space-between;
            position: relative;
        }
        .logo-title { display: flex; align-items: center; gap: 15px; }
        .logo { width: 50px; height: auto; }
        .header h1 { font-size: 1.8rem; color: #DC2626; }
        
        /* å¯¼èˆªæ  */
        .header-nav {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        #user-info-display {
            display: none;
            align-items: center;
            gap: 15px;
        }
        
        #username-display {
            font-size: 0.9rem;
            font-weight: 600;
            color: #333;
        }

        #logout-button {
            padding: 8px 20px;
            background: #f0f0f0;
            color: #DC2626;
            border: 2px solid #f0f0f0;
            border-radius: 6px;
            transition: all 0.3s;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
        }
        
        #logout-button:hover {
            border: 2px solid #DC2626;
            color: #DC2626;
            background: white;
        }

        .nav-link {
            padding: 8px 20px;
            color: #666;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.3s;
            font-weight: 500;
            background: transparent;
            border: 2px solid transparent;
            cursor: pointer;
        }

        .nav-link:hover {
            color: #DC2626;
            background: #f0f0f0;
        }

        .nav-link.active {
            background: #DC2626;
            color: white;
        }
        
        .back-link { 
            padding: 10px 25px; 
            background: white; 
            color: #DC2626; 
            text-decoration: none; 
            border: 2px solid #DC2626; 
            border-radius: 6px; 
            font-weight: 600; 
            transition: all 0.3s; 
        }
        .back-link:hover { background: #DC2626; color: white; }
        
        /* æœç´¢åŒºåŸŸ */
        .search-container { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 40px 20px; max-width: 800px; margin: 0 auto; width: 100%; }
        .search-logo { margin-bottom: 40px; text-align: center; }
        .search-logo img { width: 200px; height: auto; margin-bottom: 20px; }
        .search-logo h2 { font-size: 2rem; color: #333; margin-bottom: 10px; }
        .search-logo p { font-size: 1.1rem; color: #666; }
        .search-box { width: 100%; max-width: 600px; }
        .search-input { width: 100%; padding: 18px 25px; font-size: 1.2rem; border: 2px solid #ddd; border-radius: 50px; outline: none; transition: all 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .search-input:focus { border-color: #DC2626; box-shadow: 0 4px 16px rgba(220, 38, 38, 0.2); }
        .search-buttons { display: flex; gap: 15px; justify-content: center; margin-top: 30px; }
        .search-btn { padding: 12px 30px; background: #DC2626; color: white; border: none; border-radius: 6px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .search-btn:hover { background: #b91c1c; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3); }
        .clear-btn { padding: 12px 30px; background: white; color: #666; border: 2px solid #ddd; border-radius: 6px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .clear-btn:hover { border-color: #DC2626; color: #DC2626; }
        .search-tips { margin-top: 40px; text-align: center; color: #666; }
        .search-tips p { margin: 8px 0; font-size: 0.95rem; }
        .search-tips strong { color: #DC2626; }
        
        /* ç»“æœåŒºåŸŸ */
        .results-section { display: none; height: calc(100vh - 100px); overflow: hidden; }
        .split-container { display: flex; height: 100%; }
        .left-panel { width: 35%; background: #f8f9fa; border-right: 2px solid #e5e7eb; display: flex; flex-direction: column; overflow: hidden; }
        .results-header { background: white; padding: 20px 25px; border-bottom: 2px solid #e5e7eb; flex-shrink: 0; }
        .results-count { font-size: 1.1rem; color: #666; margin-bottom: 15px; }
        .results-count strong { color: #DC2626; font-size: 1.3rem; }
        .results-list { flex: 1; overflow-y: auto; padding: 20px; }
        .result-item { background: white; border-radius: 12px; padding: 20px; margin-bottom: 15px; cursor: pointer; transition: all 0.3s; border: 2px solid transparent; }
        .result-item:hover { border-color: #DC2626; box-shadow: 0 4px 12px rgba(220, 38, 38, 0.15); }
        .result-item.active { border-color: #DC2626; background: #fff5f5; box-shadow: 0 4px 12px rgba(220, 38, 38, 0.2); }
        .result-item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .result-land-number { font-size: 1.3rem; font-weight: 700; color: #DC2626; }
        .result-badges { display: flex; gap: 5px; }
        .result-badge { padding: 3px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 600; color: white; }
        .badge-type { background: #DC2626; }
        .badge-agent { background: #2563eb; }
        .result-item-body { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .result-detail { display: flex; flex-direction: column; gap: 2px; }
        .result-label { font-size: 0.75rem; color: #999; }
        .result-value { font-size: 0.9rem; font-weight: 600; color: #333; }
        .result-price { grid-column: 1 / -1; text-align: center; margin-top: 8px; padding-top: 12px; border-top: 1px solid #e5e7eb; }
        .result-price-amount { font-size: 1.5rem; font-weight: 700; color: #DC2626; }
        .no-price-badge { display: inline-block; padding: 6px 16px; background: #f59e0b; color: white; border-radius: 6px; font-size: 0.9rem; font-weight: 600; }
        .right-panel { width: 65%; background: white; overflow-y: auto; }
        .detail-container { max-width: 900px; margin: 0 auto; padding: 40px; }
        .detail-header { margin-bottom: 30px; }
        .detail-title { font-size: 2rem; font-weight: 700; color: #DC2626; margin-bottom: 15px; }
        .detail-location { display: flex; align-items: center; gap: 8px; font-size: 1.1rem; color: #666; margin-bottom: 20px; }
        .detail-badges { display: flex; gap: 10px; flex-wrap: wrap; }
        .detail-badge { padding: 6px 15px; border-radius: 6px; font-size: 0.9rem; font-weight: 600; color: white; }
        .detail-map { width: 100%; height: 400px; border-radius: 12px; overflow: hidden; margin-bottom: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .detail-info-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; padding: 30px; background: #f8f9fa; border-radius: 12px; }
        .info-item { text-align: center; }
        .info-label { font-size: 0.9rem; color: #999; margin-bottom: 8px; }
        .info-value { font-size: 1.3rem; font-weight: 700; color: #333; }
        .detail-price-section { background: linear-gradient(135deg, #DC2626 0%, #b91c1c 100%); padding: 40px; border-radius: 12px; text-align: center; margin-bottom: 30px; color: white; }
        .detail-price-label { font-size: 1rem; opacity: 0.9; margin-bottom: 10px; }
        .detail-price-amount { font-size: 3rem; font-weight: 700; }
        .detail-price-unit { font-size: 1.2rem; margin-left: 10px; }
        .detail-price-per-ping { font-size: 1.1rem; opacity: 0.9; margin-top: 10px; }
        .detail-actions { display: flex; gap: 15px; justify-content: center; }
        .action-btn { padding: 15px 40px; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .btn-primary { background: #DC2626; color: white; }
        .btn-primary:hover { background: #b91c1c; transform: translateY(-2px); box-shadow: 0 6px 16px rgba(220, 38, 38, 0.3); }
        .btn-secondary { background: #2563eb; color: white; }
        .btn-secondary:hover { background: #1d4ed8; transform: translateY(-2px); box-shadow: 0 6px 16px rgba(37, 99, 235, 0.3); }
        .btn-success { background: #059669; color: white; }
        .btn-success:hover { background: #047857; transform: translateY(-2px); box-shadow: 0 6px 16px rgba(5, 150, 105, 0.3); }
        .no-results { text-align: center; padding: 60px 20px; }
        .no-results h3 { font-size: 1.5rem; color: #666; margin-bottom: 15px; }
        .empty-state { text-align: center; padding: 100px 40px; color: #aaa; }
        .empty-state h3 { font-size: 1.8rem; margin-bottom: 15px; }
        .empty-state p { font-size: 1.1rem; }

        /* ç™»å…¥æ¨¡æ…‹æ¡† */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.show {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: white;
            padding: 30px 40px;
            border-radius: 12px;
            width: 90%;
            max-width: 550px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            position: relative;
            transform: scale(0.95);
            transition: transform 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-overlay.show .modal-content {
            transform: scale(1);
        }

        .close-modal-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 2rem;
            color: #aaa;
            cursor: pointer;
            line-height: 1;
            transition: color 0.2s;
        }

        .close-modal-btn:hover {
            color: #333;
        }

        .modal-content h2 {
            text-align: center;
            color: #DC2626;
            margin-bottom: 25px;
            font-size: 1.8rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input[type="text"],
        .form-group input[type="password"],
        .form-group input[type="email"] {
            width: 100%;
            padding: 12px;
            font-size: 1rem;
            border: 1px solid #ddd;
            border-radius: 6px;
        }

        .form-group input:focus {
            outline: none;
            border-color: #DC2626;
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
        }

        .modal-action-btn {
            width: 100%;
            padding: 12px;
            background: #DC2626;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-action-btn:hover {
            background: #b91c1c;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
        }

        .form-switcher {
            text-align: center;
            margin-top: 20px;
            font-size: 0.9rem;
            color: #666;
        }

        .form-switcher a {
            color: #DC2626;
            text-decoration: none;
            font-weight: 600;
        }

        .form-switcher a:hover {
            text-decoration: underline;
        }

        /* æœƒå“¡èº«åˆ†é¸æ“‡æ¨™ç±¤ */
        .member-tabs {
            display: flex;
            border-bottom: 2px solid #f0f0f0;
            margin-bottom: 25px;
            gap: 0;
        }

        .member-tab {
            flex: 1;
            padding: 12px 15px;
            text-align: center;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .member-tab:hover {
            background: #e9ecef;
            color: #333;
        }

        .member-tab.active {
            background: white;
            color: #DC2626;
            border-bottom: 3px solid #DC2626;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .member-notice {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            font-size: 0.85rem;
            color: #856404;
            line-height: 1.6;
        }

        .member-notice strong {
            display: block;
            margin-bottom: 5px;
            color: #664d03;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="logo-title">
            <img src="https://via.placeholder.com/50x50?text=Logo" alt="Logo" class="logo">
            <h1>ä¸€å¦‚åœ°è™Ÿæœå°‹</h1>
        </div>
        <div class="header-nav">
            <a href="index.html" class="back-link">è¿”å›ä¸»é </a>
            <a href="#" class="nav-link" id="login-nav-button">ç™»å…¥ / è¨»å†Š</a>
            <div id="user-info-display">
                <span id="username-display"></span>
                <button id="logout-button">ç™»å‡º</button>
            </div>
        </div>
    </div>

    <!-- æœç´¢å®¹å™¨ -->
    <div class="search-container">
        <div class="search-logo">
            <img src="https://via.placeholder.com/200x100?text=ä¸€å¦‚åœ°ç”¢" alt="ä¸€å¦‚åœ°ç”¢">
            <h2>ğŸ” å¿«é€Ÿåœ°è™Ÿæœå°‹</h2>
            <p>è¼¸å…¥åœ°è™Ÿå³å¯æŸ¥è©¢åœŸåœ°è©³ç´°è³‡è¨Š</p>
        </div>
        <div class="search-box">
            <input type="text" id="landNumberInput" class="search-input" placeholder="è«‹è¼¸å…¥åœ°è™Ÿ (ä¾‹å¦‚: 25, 69, 138)">
            <div class="search-buttons">
                <button class="search-btn" onclick="searchLandNumber()">ğŸ” é–‹å§‹æœå°‹</button>
                <button class="clear-btn" onclick="clearSearch()">ğŸ”„ æ¸…é™¤</button>
            </div>
        </div>
        <div class="search-tips">
            <p><strong>ğŸ’¡ æœå°‹æç¤º:</strong></p>
            <p>â€¢ å¯è¼¸å…¥å–®ä¸€æˆ–å¤šå€‹åœ°è™Ÿ (ç”¨ç©ºæ ¼æˆ–é€—è™Ÿåˆ†éš”)</p>
            <p>â€¢ ç¯„ä¾‹: 25 æˆ– 25, 69, 138</p>
        </div>
    </div>

    <!-- æœç´¢ç»“æœåŒºåŸŸ -->
    <section id="resultsSection" class="results-section">
        <div class="split-container">
            <div class="left-panel">
                <div class="results-header">
                    <div class="results-count">
                        æ‰¾åˆ° <strong id="resultCount">0</strong> ç­†ç¬¦åˆçš„åœŸåœ°
                    </div>
                    <button class="search-btn" onclick="clearSearch()" style="width: 100%;">è¿”å›æœå°‹</button>
                </div>
                <div class="results-list" id="resultsList"></div>
            </div>
            <div class="right-panel">
                <div class="detail-container" id="detailPanel">
                    <div class="empty-state">
                        <h3>è«‹é¸æ“‡å·¦å´çš„åœŸåœ°</h3>
                        <p>æŸ¥çœ‹è©³ç´°è³‡è¨Š</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ç™»å…¥æ¨¡æ…‹æ¡† -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal-content">
            <button class="close-modal-btn" onclick="closeLoginModal()">&times;</button>
            
            <div id="loginForm">
                <h2>æœƒå“¡ç™»å…¥</h2>
                
                <!-- ç™»å…¥èº«åˆ†é¸æ“‡ -->
                <div class="member-tabs">
                    <button class="member-tab active" onclick="switchMemberTab('landlord')">åœ°ä¸»/ä»£ç†äºº</button>
                    <button class="member-tab" onclick="switchMemberTab('developer')">æ³•äºº/å»ºå•†/åœŸé–‹</button>
                    <button class="member-tab" onclick="switchMemberTab('agent')">ä»²ä»‹ç‡Ÿæ¥­/ç¶“ç´€äºº</button>
                </div>

                <!-- åœ°ä¸»ç™»å…¥ -->
                <div id="landlord-tab" class="tab-content active">
                    <div class="member-notice">
                        <strong>ğŸ¡ åœ°ä¸»æœƒå“¡</strong>
                        æ‚¨å¯ä»¥ä½¿ç”¨æ‰‹æ©Ÿè™Ÿç¢¼æˆ–é›»å­éƒµä»¶ç™»å…¥æŸ¥çœ‹æ›´å¤šåœŸåœ°è³‡è¨Šã€‚
                    </div>
                    <div class="form-group">
                        <label for="landlordAccount">å¸³è™Ÿ(æ‰‹æ©Ÿæˆ–é›»å­éƒµä»¶)</label>
                        <input type="text" id="landlordAccount" placeholder="è«‹è¼¸å…¥æ‚¨çš„æ‰‹æ©Ÿè™Ÿç¢¼æˆ–é›»å­éƒµä»¶">
                    </div>
                    <div class="form-group">
                        <label for="landlordPassword">å¯†ç¢¼</label>
                        <input type="password" id="landlordPassword" placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
                    </div>
                    <button class="modal-action-btn" onclick="handleMemberLogin('landlord')">ç™»å…¥</button>
                </div>

                <!-- æ³•äºº/å»ºå•†/åœŸé–‹ -->
                <div id="developer-tab" class="tab-content">
                    <div class="member-notice">
                        <strong>âš ï¸ ä¼æ¥­æœƒå“¡é ˆçŸ¥</strong>
                        æ³•äººæœƒå“¡éœ€æä¾›å…¬å¸çµ±ä¸€ç·¨è™Ÿé€²è¡Œé©—è­‰,ä»¥ç¢ºä¿äº¤æ˜“å®‰å…¨èˆ‡ä¿¡ç”¨ã€‚
                    </div>
                    <div class="form-group">
                        <label for="developerAccount">å…¬å¸çµ±ä¸€ç·¨è™Ÿ</label>
                        <input type="text" id="developerAccount" placeholder="è«‹è¼¸å…¥8ä½æ•¸çµ±ä¸€ç·¨è™Ÿ" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label for="developerEmail">é›»å­éƒµä»¶</label>
                        <input type="email" id="developerEmail" placeholder="è«‹è¼¸å…¥å…¬å¸é›»å­éƒµä»¶">
                    </div>
                    <div class="form-group">
                        <label for="developerPassword">å¯†ç¢¼</label>
                        <input type="password" id="developerPassword" placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
                    </div>
                    <button class="modal-action-btn" onclick="handleMemberLogin('developer')">ç™»å…¥</button>
                </div>

                <!-- ä»²ä»‹ç‡Ÿæ¥­/ç¶“ç´€äºº -->
                <div id="agent-tab" class="tab-content">
                    <div class="member-notice">
                        <strong>âš ï¸ å°ˆæ¥­äººå“¡èªè­‰</strong>
                        ä»²ä»‹ç‡Ÿæ¥­å“¡åŠä¸å‹•ç”¢ç¶“ç´€äººéœ€æä¾›è­‰ç…§å­—è™Ÿé€²è¡Œèº«åˆ†é©—è­‰ã€‚
                    </div>
                    <div class="form-group">
                        <label for="agentLicense">è­‰ç…§å­—è™Ÿ</label>
                        <input type="text" id="agentLicense" placeholder="è«‹è¼¸å…¥ç‡Ÿæ¥­å“¡æˆ–ç¶“ç´€äººè­‰ç…§å­—è™Ÿ">
                    </div>
                    <div class="form-group">
                        <label for="agentAccount">å¸³è™Ÿ(æ‰‹æ©Ÿæˆ–é›»å­éƒµä»¶)</label>
                        <input type="text" id="agentAccount" placeholder="è«‹è¼¸å…¥æ‚¨çš„æ‰‹æ©Ÿè™Ÿç¢¼æˆ–é›»å­éƒµä»¶">
                    </div>
                    <div class="form-group">
                        <label for="agentPassword">å¯†ç¢¼</label>
                        <input type="password" id="agentPassword" placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
                    </div>
                    <button class="modal-action-btn" onclick="handleMemberLogin('agent')">ç™»å…¥</button>
                </div>

                <p class="form-switcher">é‚„ä¸æ˜¯æœƒå“¡? <a href="#" id="showRegisterLink">ç«‹å³è¨»å†Š</a></p>
            </div>

            <div id="registerForm" style="display: none;">
                <h2>åŠ å…¥æœƒå“¡</h2>
                
                <!-- è¨»å†Šèº«åˆ†é¸æ“‡ -->
                <div class="member-tabs">
                    <button class="member-tab active" onclick="switchRegisterTab('landlord')">åœ°ä¸»/ä»£ç†äºº</button>
                    <button class="member-tab" onclick="switchRegisterTab('developer')">æ³•äºº/å»ºå•†/åœŸé–‹</button>
                    <button class="member-tab" onclick="switchRegisterTab('agent')">ä»²ä»‹ç‡Ÿæ¥­/ç¶“ç´€äºº</button>
                </div>

                <!-- åœ°ä¸»è¨»å†Š -->
                <div id="register-landlord-tab" class="tab-content active">
                    <div class="member-notice">
                        <strong>ğŸ“ è¨»å†Šèªªæ˜</strong>
                        åœ°ä¸»æœƒå“¡å¯å…è²»æŸ¥è©¢åœŸåœ°è³‡è¨Š,äº«æœ‰å°ˆå±¬çš„åœŸåœ°ç®¡ç†åŠŸèƒ½ã€‚
                    </div>
                    <div class="form-group">
                        <label for="regLandlordName">å§“å</label>
                        <input type="text" id="regLandlordName" placeholder="è«‹è¼¸å…¥çœŸå¯¦å§“å">
                    </div>
                    <div class="form-group">
                        <label for="regLandlordAccount">æ‰‹æ©Ÿæˆ–é›»å­éƒµä»¶</label>
                        <input type="text" id="regLandlordAccount" placeholder="è«‹è¼¸å…¥æ‰‹æ©Ÿè™Ÿç¢¼æˆ–é›»å­éƒµä»¶">
                    </div>
                    <div class="form-group">
                        <label for="regLandlordPassword">è¨­å®šå¯†ç¢¼</label>
                        <input type="password" id="regLandlordPassword" placeholder="è«‹è¨­å®šè‡³å°‘6ä½æ•¸å¯†ç¢¼">
                    </div>
                    <button class="modal-action-btn" onclick="handleMemberRegister('landlord')">è¨»å†Š</button>
                </div>

                <!-- æ³•äººè¨»å†Š -->
                <div id="register-developer-tab" class="tab-content">
                    <div class="member-notice">
                        <strong>ğŸ“ ä¼æ¥­æœƒå“¡è¨»å†Š</strong>
                        è¨»å†Šå¾Œè«‹æº–å‚™å…¬å¸ç™»è¨˜è­‰æ˜æ–‡ä»¶,å®Œæˆä¼æ¥­èªè­‰å¾Œå³å¯ä½¿ç”¨å®Œæ•´åŠŸèƒ½ã€‚
                    </div>
                    <div class="form-group">
                        <label for="regDeveloperCompany">å…¬å¸åç¨±</label>
                        <input type="text" id="regDeveloperCompany" placeholder="è«‹è¼¸å…¥å…¬å¸å…¨å">
                    </div>
                    <div class="form-group">
                        <label for="regDeveloperTaxId">çµ±ä¸€ç·¨è™Ÿ</label>
                        <input type="text" id="regDeveloperTaxId" placeholder="è«‹è¼¸å…¥8ä½æ•¸çµ±ä¸€ç·¨è™Ÿ" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label for="regDeveloperEmail">å…¬å¸é›»å­éƒµä»¶</label>
                        <input type="email" id="regDeveloperEmail" placeholder="è«‹è¼¸å…¥å…¬å¸é›»å­éƒµä»¶">
                    </div>
                    <div class="form-group">
                        <label for="regDeveloperPassword">è¨­å®šå¯†ç¢¼</label>
                        <input type="password" id="regDeveloperPassword" placeholder="è«‹è¨­å®šè‡³å°‘6ä½æ•¸å¯†ç¢¼">
                    </div>
                    <button class="modal-action-btn" onclick="handleMemberRegister('developer')">è¨»å†Š</button>
                </div>

                <!-- ä»²ä»‹è¨»å†Š -->
                <div id="register-agent-tab" class="tab-content">
                    <div class="member-notice">
                        <strong>ğŸ“ å°ˆæ¥­äººå“¡è¨»å†Š</strong>
                        è¨»å†Šå¾Œè«‹ä¸Šå‚³ç‡Ÿæ¥­å“¡è­‰æˆ–ç¶“ç´€äººè­‰ç…§,å¯©æ ¸é€šéå¾Œå³å¯é–‹å§‹ä½¿ç”¨å°ˆæ¥­åŠŸèƒ½ã€‚
                    </div>
                    <div class="form-group">
                        <label for="regAgentName">å§“å</label>
                        <input type="text" id="regAgentName" placeholder="è«‹è¼¸å…¥çœŸå¯¦å§“å">
                    </div>
                    <div class="form-group">
                        <label for="regAgentLicense">è­‰ç…§å­—è™Ÿ</label>
                        <input type="text" id="regAgentLicense" placeholder="è«‹è¼¸å…¥ç‡Ÿæ¥­å“¡æˆ–ç¶“ç´€äººè­‰ç…§å­—è™Ÿ">
                    </div>
                    <div class="form-group">
                        <label for="regAgentAccount">æ‰‹æ©Ÿæˆ–é›»å­éƒµä»¶</label>
                        <input type="text" id="regAgentAccount" placeholder="è«‹è¼¸å…¥æ‰‹æ©Ÿè™Ÿç¢¼æˆ–é›»å­éƒµä»¶">
                    </div>
                    <div class="form-group">
                        <label for="regAgentPassword">è¨­å®šå¯†ç¢¼</label>
                        <input type="password" id="regAgentPassword" placeholder="è«‹è¨­å®šè‡³å°‘6ä½æ•¸å¯†ç¢¼">
                    </div>
                    <button class="modal-action-btn" onclick="handleMemberRegister('agent')">è¨»å†Š</button>
                </div>

                <p class="form-switcher">å·²ç¶“æ˜¯æœƒå“¡? <a href="#" id="showLoginLink">è¿”å›ç™»å…¥</a></p>
            </div>
        </div>
    </div>

    <script>
        let currentResults = [];
        let selectedLandId = null;
        let currentUser = null;
        let currentMemberType = 'landlord';
        let currentRegisterType = 'landlord';
        
        const landDatabase = [
            { id: 1, number: '25', title: 'ä¿¡ç¾©å€ç²¾è¯å•†æ¥­åœ°', district: 'ä¿¡ç¾©å€', area: 456.3, type: 'å•†æ¥­åœ°', totalPrice: 102500, pricePerPing: 224.6, agentType: 'å°ˆä»»', delegationStatus: 'å·²å§”è¨—', lat: 25.0330, lng: 121.5654, ownerPhone: '0912-345-678', ownerContact: 'ç‹å…ˆç”Ÿ', landPurpose: 'å•†æ¥­ä½¿ç”¨', zoning: 'å•†æ¥­å€' },
            { id: 2, number: '69', title: 'å¤§å®‰å€ä½å®…å»ºåœ°', district: 'å¤§å®‰å€', area: 234.5, type: 'å»ºåœ°', totalPrice: 48900, pricePerPing: 208.5, agentType: 'ä¸€èˆ¬', delegationStatus: 'å·²å§”è¨—', lat: 25.0297, lng: 121.5432, ownerPhone: '0923-456-789', ownerContact: 'æå°å§', landPurpose: 'ä½å®…é–‹ç™¼', zoning: 'ä½å®…å€' },
            { id: 3, number: '138', title: 'æ¾å±±å€éƒ½æœƒå»ºåœ°', district: 'æ¾å±±å€', area: 187.2, type: 'å»ºåœ°', totalPrice: 37500, pricePerPing: 200.3, agentType: 'å°ˆä»»', delegationStatus: 'æœªå§”è¨—', lat: 25.0504, lng: 121.5778, ownerPhone: '0934-567-890', ownerContact: 'å¼µç¸½ç¶“ç†', landPurpose: 'å•†ä½æ··åˆ', zoning: 'å•†æ¥­å€' },
            { id: 4, number: '15', title: 'ä¸­å±±å€ç²¾è¯åœ°æ®µ', district: 'ä¸­å±±å€', area: 145.8, type: 'å•†æ¥­åœ°', totalPrice: null, pricePerPing: null, agentType: 'ä¸€èˆ¬', delegationStatus: 'æœªå§”è¨—', lat: 25.0636, lng: 121.5268, ownerPhone: '0945-678-901', ownerContact: 'é™³è‘£äº‹é•·', landPurpose: 'å•†æ¥­é–‹ç™¼', zoning: 'å•†æ¥­å€' },
            { id: 5, number: '66', title: 'å¤§å®‰å€å•†æ¥­é»ƒé‡‘åœ°æ®µ', district: 'å¤§å®‰å€', area: 203.4, type: 'å•†æ¥­åœ°', totalPrice: 45600, pricePerPing: 224.2, agentType: 'å°ˆä»»', delegationStatus: 'å·²å§”è¨—', lat: 25.0330, lng: 121.5654, ownerPhone: '0956-789-012', ownerContact: 'åŠ‰ç¶“ç†', landPurpose: 'å•†æ¥­å¤§æ¨“', zoning: 'å•†æ¥­å€' },
            { id: 6, number: '69', title: 'å¤§å®‰å€ä½å®…å»ºåœ°', district: 'å¤§å®‰å€', area: 176.9, type: 'å»ºåœ°', totalPrice: 38200, pricePerPing: 216.0, agentType: 'ä¸€èˆ¬', delegationStatus: 'å·²å§”è¨—', lat: 25.0297, lng: 121.5432, ownerPhone: '0967-890-123', ownerContact: 'æ—å…ˆç”Ÿ', landPurpose: 'ä½å®…å»ºè¨­', zoning: 'ä½å®…å€' },
            { id: 7, number: '25', title: 'ä¿¡ç¾©å€éƒ½æœƒå»ºåœ°', district: 'ä¿¡ç¾©å€', area: 145.3, type: 'å»ºåœ°', totalPrice: null, pricePerPing: null, agentType: 'å°ˆä»»', delegationStatus: 'æœªå§”è¨—', lat: 25.0330, lng: 121.5770, ownerPhone: '0978-901-234', ownerContact: 'å³å°å§', landPurpose: 'å•†æ¥­é–‹ç™¼', zoning: 'å•†æ¥­å€' },
            { id: 8, number: '138', title: 'æ¾å±±å€ä½å•†æ··åˆ', district: 'æ¾å±±å€', area: 92.7, type: 'å»ºåœ°', totalPrice: 16400, pricePerPing: 176.9, agentType: 'ä¸€èˆ¬', delegationStatus: 'å·²å§”è¨—', lat: 25.0504, lng: 121.5778, ownerPhone: '0989-012-345', ownerContact: 'é»ƒè‘£', landPurpose: 'å•†ä½æ··åˆ', zoning: 'å•†æ¥­å€' },
            { id: 9, number: '15', title: 'ä¸­å±±å€ç²¾è¯åœ°æ®µ', district: 'ä¸­å±±å€', area: 68.5, type: 'å»ºåœ°', totalPrice: 13200, pricePerPing: 192.7, agentType: 'å°ˆä»»', delegationStatus: 'å·²å§”è¨—', lat: 25.0636, lng: 121.5268, ownerPhone: '0901-123-456', ownerContact: 'å‘¨å…ˆç”Ÿ', landPurpose: 'ä½å®…å»ºè¨­', zoning: 'ä½å®…å€' },
            { id: 10, number: '49', title: 'å£«æ—å€è¾²æ¥­ç”¨åœ°', district: 'å£«æ—å€', area: 234.6, type: 'è¾²åœ°', totalPrice: 18700, pricePerPing: 79.7, agentType: 'ä¸€èˆ¬', delegationStatus: 'æœªå§”è¨—', lat: 25.0938, lng: 121.5252, ownerPhone: '0912-234-567', ownerContact: 'é„­å…ˆç”Ÿ', landPurpose: 'è¾²æ¥­ä½¿ç”¨', zoning: 'è¾²æ¥­å€' },
            { id: 11, number: '68', title: 'åŒ—æŠ•å€æº«æ³‰å€å»ºåœ°', district: 'åŒ—æŠ•å€', area: 187.3, type: 'å»ºåœ°', totalPrice: 15300, pricePerPing: 81.7, agentType: 'å°ˆä»»', delegationStatus: 'å·²å§”è¨—', lat: 25.1368, lng: 121.5018, ownerPhone: '0923-345-678', ownerContact: 'å­«å°å§', landPurpose: 'æº«æ³‰é£¯åº—', zoning: 'ç‰¹å®šå°ˆç”¨å€' },
            { id: 12, number: '12', title: 'æ–‡å±±å€å±±å¡åœ°å»ºåœ°', district: 'æ–‡å±±å€', area: 95.8, type: 'å»ºåœ°', totalPrice: 9800, pricePerPing: 102.3, agentType: 'ä¸€èˆ¬', delegationStatus: 'æœªå§”è¨—', lat: 24.9890, lng: 121.5710, ownerPhone: '0934-456-789', ownerContact: 'ä½•å…ˆç”Ÿ', landPurpose: 'ä½å®…å»ºè¨­', zoning: 'ä½å®…å€' },
            { id: 13, number: '16', title: 'å—æ¸¯å€å·¥æ¥­ç”¨åœ°', district: 'å—æ¸¯å€', area: 112.4, type: 'å·¥æ¥­åœ°', totalPrice: 11500, pricePerPing: 102.3, agentType: 'å°ˆä»»', delegationStatus: 'å·²å§”è¨—', lat: 25.0519, lng: 121.6073, ownerPhone: '0945-567-890', ownerContact: 'è¬ç¸½', landPurpose: 'å·¥æ¥­å» æˆ¿', zoning: 'å·¥æ¥­å€' }
        ];

        // åˆ‡æ›ç™»å…¥èº«åˆ†æ¨™ç±¤
        function switchMemberTab(type) {
            currentMemberType = type;
            document.querySelectorAll('#loginForm .member-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            document.querySelectorAll('#loginForm .tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${type}-tab`).classList.add('active');
        }

        // åˆ‡æ›è¨»å†Šèº«åˆ†æ¨™ç±¤
        function switchRegisterTab(type) {
            currentRegisterType = type;
            document.querySelectorAll('#registerForm .member-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            document.querySelectorAll('#registerForm .tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`register-${type}-tab`).classList.add('active');
        }

        // æª¢æŸ¥ä¸¦æ›´æ–°ç”¨æˆ¶ç•Œé¢
        function updateHeaderUI() {
            const loginButton = document.getElementById('login-nav-button');
            const userInfoDisplay = document.getElementById('user-info-display');
            const usernameDisplay = document.getElementById('username-display');
            
            const storedUser = sessionStorage.getItem('currentUser');
            if (storedUser) {
                currentUser = JSON.parse(storedUser);
            }

            if (currentUser) {
                loginButton.style.display = 'none';
                userInfoDisplay.style.display = 'flex';
                usernameDisplay.textContent = `æ­¡è¿, ${currentUser.name} (${currentUser.type})`;
            } else {
                loginButton.style.display = 'block';
                userInfoDisplay.style.display = 'none';
            }
        }

        // è™•ç†æœƒå“¡ç™»å…¥
        function handleMemberLogin(type) {
            let account, password, name, additionalInfo, memberId;
            
            switch(type) {
                case 'landlord':
                    account = document.getElementById('landlordAccount').value.trim();
                    password = document.getElementById('landlordPassword').value.trim();
                    name = account;
                    additionalInfo = 'åœ°ä¸»/ä»£ç†äºº';
                    memberId = 'LD-' + Math.random().toString(36).substr(2, 9).toUpperCase();
                    break;
                case 'developer':
                    account = document.getElementById('developerAccount').value.trim();
                    const email = document.getElementById('developerEmail').value.trim();
                    password = document.getElementById('developerPassword').value.trim();
                    name = `çµ±ç·¨:${account}`;
                    additionalInfo = 'æ³•äºº/å»ºå•†';
                    memberId = 'DEV-' + account;
                    
                    if (account.length !== 8 || isNaN(account)) {
                        alert('è«‹è¼¸å…¥æ­£ç¢ºçš„8ä½æ•¸çµ±ä¸€ç·¨è™Ÿ!');
                        return;
                    }
                    if (!email) {
                        alert('è«‹è¼¸å…¥é›»å­éƒµä»¶!');
                        return;
                    }
                    break;
                case 'agent':
                    const license = document.getElementById('agentLicense').value.trim();
                    account = document.getElementById('agentAccount').value.trim();
                    password = document.getElementById('agentPassword').value.trim();
                    name = account;
                    additionalInfo = 'ä»²ä»‹ç‡Ÿæ¥­/ç¶“ç´€äºº';
                    memberId = 'AGT-' + license;
                    
                    if (!license) {
                        alert('è«‹è¼¸å…¥è­‰ç…§å­—è™Ÿ!');
                        return;
                    }
                    break;
            }
            
            if (!account) {
                alert('è«‹è¼¸å…¥å¸³è™Ÿ!');
                return;
            }
            if (!password) {
                alert('è«‹è¼¸å…¥å¯†ç¢¼!');
                return;
            }
            
            currentUser = { 
                memberId: memberId,
                name: name, 
                type: additionalInfo, 
                role: type,
                account: account
            };
            sessionStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            alert(`ç™»å…¥æˆåŠŸ!\næœƒå“¡ID: ${memberId}\nå§“å: ${name}\nèº«åˆ†: ${additionalInfo}`);
            closeLoginModal();
            updateHeaderUI();
        }

        // è™•ç†æœƒå“¡è¨»å†Š
        function handleMemberRegister(type) {
            let name, account, password, additionalInfo;
            
            switch(type) {
                case 'landlord':
                    name = document.getElementById('regLandlordName').value.trim();
                    account = document.getElementById('regLandlordAccount').value.trim();
                    password = document.getElementById('regLandlordPassword').value.trim();
                    additionalInfo = 'åœ°ä¸»/ä»£ç†äºº';
                    
                    if (!name) {
                        alert('è«‹è¼¸å…¥å§“å!');
                        return;
                    }
                    break;
                case 'developer':
                    const company = document.getElementById('regDeveloperCompany').value.trim();
                    const taxId = document.getElementById('regDeveloperTaxId').value.trim();
                    account = document.getElementById('regDeveloperEmail').value.trim();
                    password = document.getElementById('regDeveloperPassword').value.trim();
                    name = company;
                    additionalInfo = 'æ³•äºº/å»ºå•†';
                    
                    if (!company) {
                        alert('è«‹è¼¸å…¥å…¬å¸åç¨±!');
                        return;
                    }
                    if (taxId.length !== 8 || isNaN(taxId)) {
                        alert('è«‹è¼¸å…¥æ­£ç¢ºçš„8ä½æ•¸çµ±ä¸€ç·¨è™Ÿ!');
                        return;
                    }
                    break;
                case 'agent':
                    name = document.getElementById('regAgentName').value.trim();
                    const license = document.getElementById('regAgentLicense').value.trim();
                    account = document.getElementById('regAgentAccount').value.trim();
                    password = document.getElementById('regAgentPassword').value.trim();
                    additionalInfo = 'ä»²ä»‹ç‡Ÿæ¥­/ç¶“ç´€äºº';
                    
                    if (!name) {
                        alert('è«‹è¼¸å…¥å§“å!');
                        return;
                    }
                    if (!license) {
                        alert('è«‹è¼¸å…¥è­‰ç…§å­—è™Ÿ!');
                        return;
                    }
                    break;
            }
            
            if (!account) {
                alert('è«‹è¼¸å…¥å¸³è™Ÿ!');
                return;
            }
            if (!password || password.length < 6) {
                alert('è«‹è¨­å®šè‡³å°‘6ä½æ•¸å¯†ç¢¼!');
                return;
            }
            
            alert(`è¨»å†ŠæˆåŠŸ!\næ­¡è¿åŠ å…¥ ${additionalInfo} æœƒå“¡!\n\nè«‹ä½¿ç”¨æ‚¨çš„å¸³è™Ÿå¯†ç¢¼ç™»å…¥ã€‚`);
            
            // åˆ‡æ›å›ç™»å…¥è¡¨å–®
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
        }

        // è™•ç†ç™»å‡º
        function handleLogout() {
            if (confirm('ç¢ºå®šè¦ç™»å‡ºå—?')) {
                currentUser = null;
                sessionStorage.removeItem('currentUser');
                updateHeaderUI();
                alert('å·²æˆåŠŸç™»å‡º!');
            }
        }

        function searchLandNumber() {
            const input = document.getElementById('landNumberInput').value.trim();
            if (!input) { 
                alert('è«‹è¼¸å…¥åœ°è™Ÿ'); 
                return; 
            }
            const searchNumbers = input.split(/[\s,ï¼Œ]+/).filter(n => n);
            const results = landDatabase.filter(land => searchNumbers.some(num => land.number === num));
            displayResults(results, searchNumbers);
        }

        function displayResults(results, searchTerms) {
            document.querySelector('.search-container').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';
            document.getElementById('resultCount').textContent = results.length;
            currentResults = results;
            if (results.length === 0) {
                document.getElementById('resultsList').innerHTML = '<div class="no-results"><h3>ğŸ˜• æ‰¾ä¸åˆ°ç›¸é—œåœ°è™Ÿ</h3><p>æœå°‹çš„åœ°è™Ÿ:' + searchTerms.join(', ') + '</p></div>';
                document.getElementById('detailPanel').innerHTML = '<div class="empty-state"><h3>æ‰¾ä¸åˆ°çµæœ</h3><p>è«‹é‡æ–°æœå°‹</p></div>';
            } else {
                renderResultsList(results);
                selectLand(results[0].id);
            }
        }

        function renderResultsList(results) {
            const listHTML = results.map(land => {
                const hasPrice = land.totalPrice !== null;
                return '<div class="result-item" onclick="selectLand(' + land.id + ')"><div class="result-item-header"><div class="result-land-number">åœ°è™Ÿ ' + land.number + '</div><div class="result-badges"><span class="result-badge badge-type">' + land.type + '</span><span class="result-badge badge-agent">' + land.agentType + '</span></div></div><div class="result-item-body"><div class="result-detail"><div class="result-label">å€åŸŸ</div><div class="result-value">' + land.district + '</div></div><div class="result-detail"><div class="result-label">é¢ç©</div><div class="result-value">' + land.area + ' åª</div></div><div class="result-price">' + (hasPrice ? '<div class="result-price-amount">' + formatPrice(land.totalPrice) + ' è¬</div>' : '<div class="no-price-badge">å°šç„¡è³£å®¶</div>') + '</div></div></div>';
            }).join('');
            document.getElementById('resultsList').innerHTML = listHTML;
        }

        function selectLand(landId) {
            selectedLandId = landId;
            const land = currentResults.find(l => l.id === landId);
            document.querySelectorAll('.result-item').forEach((item, index) => {
                item.classList.toggle('active', currentResults[index].id === landId);
            });
            renderDetailPanel(land);
        }

        function renderDetailPanel(land) {
            const hasPrice = land.totalPrice !== null;
            const detailHTML = '<div class="detail-header"><div class="detail-title">åœ°è™Ÿ ' + land.number + ' - ' + land.title + '</div><div class="detail-location">ğŸ“ å°åŒ—å¸‚ ' + land.district + '</div><div class="detail-badges"><span class="detail-badge" style="background: #DC2626;">' + land.type + '</span><span class="detail-badge" style="background: #2563eb;">' + land.agentType + '</span><span class="detail-badge" style="background: ' + (land.delegationStatus === 'å·²å§”è¨—' ? '#10b981' : '#f59e0b') + ';">' + land.delegationStatus + '</span></div></div><div class="detail-map" id="detailMap"></div><div class="detail-info-grid"><div class="info-item"><div class="info-label">åœŸåœ°é¢ç©</div><div class="info-value">' + land.area + ' åª</div></div><div class="info-item"><div class="info-label">ä½¿ç”¨åˆ†å€</div><div class="info-value">' + land.type + '</div></div><div class="info-item"><div class="info-label">åœ°è™Ÿ</div><div class="info-value">' + land.number + '</div></div></div>' + (hasPrice ? '<div class="detail-price-section"><div class="detail-price-label">ç¸½åƒ¹</div><div class="detail-price-amount">' + formatPrice(land.totalPrice) + '<span class="detail-price-unit">è¬</span></div><div class="detail-price-per-ping">æ¯åª ' + land.pricePerPing.toFixed(1) + ' è¬</div></div>' : '<div class="detail-price-section" style="background: #f59e0b;"><div class="detail-price-amount" style="font-size: 2rem;">å°šç„¡è³£å®¶</div><div class="detail-price-per-ping">æ­¡è¿ä¾†é›»æ´½è©¢</div></div>') + '<div class="detail-actions"><button class="action-btn btn-primary" onclick="viewFullDetail()">æŸ¥çœ‹å®Œæ•´è³‡è¨Š</button><button class="action-btn btn-secondary" onclick="memberView()">æœƒå“¡æŸ¥çœ‹</button><button class="action-btn btn-success" onclick="contactUs()">èˆ‡æˆ‘è¯çµ¡</button></div>';
            document.getElementById('detailPanel').innerHTML = detailHTML;
            setTimeout(() => initDetailMap(land), 100);
        }

        function initDetailMap(land) {
            const mapElement = document.getElementById('detailMap');
            if (!mapElement) return;
            const map = L.map('detailMap').setView([land.lat, land.lng], 16);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            const redIcon = L.icon({ iconUrl: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iNDIiIHZpZXdCb3g9IjAgMCAzMiA0MiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTYgMEMxMC40NzcgMCA2IDQuNDc3IDYgMTBDNiAxNy41IDE2IDMwIDE2IDMwQzE2IDMwIDI2IDE3LjUgMjYgMTBDMjYgNC40NzcgMjEuNTIzIDAgMTYgMFoiIGZpbGw9IiNEQzI2MjYiLz48Y2lyY2xlIGN4PSIxNiIgY3k9IjEwIiByPSI0IiBmaWxsPSJ3aGl0ZSIvPjwvc3ZnPg==', iconSize: [32, 42], iconAnchor: [16, 42] });
            L.marker([land.lat, land.lng], { icon: redIcon }).addTo(map).bindPopup('<b>åœ°è™Ÿ ' + land.number + '</b><br>' + land.title).openPopup();
        }

        function formatPrice(price) { 
            return price.toLocaleString(); 
        }

        function viewFullDetail() { 
            if (selectedLandId) {
                window.location.href = 'indexyi.html?id=' + selectedLandId; 
            }
        }

        function memberView() {
            if (!currentUser) {
                alert('è«‹å…ˆç™»å…¥æœƒå“¡ä»¥æŸ¥çœ‹å®Œæ•´è³‡è¨Š');
                document.getElementById('loginModal').classList.add('show');
                return;
            }

            // å·²ç™»å…¥æœƒå“¡è·³è½‰åˆ°æœƒå“¡å°ˆå±¬è³‡è¨Šé é¢
            if (selectedLandId) {
                window.location.href = 'indexyi2.html?id=' + selectedLandId;
            } else {
                alert('è«‹å…ˆé¸æ“‡ä¸€ç­†åœŸåœ°');
            }
        }

        function contactUs() { 
            alert('æ„Ÿè¬æ‚¨çš„è©¢å•!æˆ‘å€‘å°‡ç›¡å¿«èˆ‡æ‚¨è¯ç¹«'); 
        }

        function clearSearch() {
            document.querySelector('.search-container').style.display = 'flex';
            document.getElementById('resultsSection').style.display = 'none';
            document.getElementById('landNumberInput').value = '';
            document.getElementById('landNumberInput').focus();
            currentResults = [];
            selectedLandId = null;
        }

        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('show');
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            // è®¾ç½®ç™»å…¥æŒ‰é’®äº‹ä»¶
            const loginNavButton = document.getElementById('login-nav-button');
            const loginModal = document.getElementById('loginModal');
            const logoutButton = document.getElementById('logout-button');
            const showRegisterLink = document.getElementById('showRegisterLink');
            const showLoginLink = document.getElementById('showLoginLink');
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');

            loginNavButton.addEventListener('click', (e) => {
                e.preventDefault();
                loginModal.classList.add('show');
            });

            logoutButton.addEventListener('click', handleLogout);

            loginModal.addEventListener('click', (e) => {
                if (e.target === loginModal) {
                    closeLoginModal();
                }
            });

            showRegisterLink.addEventListener('click', (e) => {
                e.preventDefault();
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
            });

            showLoginLink.addEventListener('click', (e) => {
                e.preventDefault();
                registerForm.style.display = 'none';
                loginForm.style.display = 'block';
            });

            // æ›´æ–°ç”¨æˆ¶ç•Œé¢
            updateHeaderUI();

            // è®¾ç½®Enteré”®æœç´¢
            document.getElementById('landNumberInput').addEventListener('keypress', function(e) { 
                if (e.key === 'Enter') searchLandNumber(); 
            });
        });
    </script>
</body>
</html>
