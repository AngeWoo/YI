<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¢èª¿åˆ†æè¡¨ - ä¸€å¦‚åœŸåœ°äº¤æ˜“ç«¶åƒ¹çœ‹æ¿</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <style>
        /* --- å…¨å±€èˆ‡å­—é«”è¨­å®š --- */
        :root {
            --primary-color: #DC2626;
            --secondary-color: #059669;
            --text-dark: #1e293b;
            --text-light: #64748b;
            --bg-light: #f7f9fc;
            --bg-white: #ffffff;
            --border-color: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'Segoe UI', Roboto, Arial, sans-serif;
            background-color: #f1f5f9;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg id='hexagons' fill='%23d1dce9' fill-opacity='0.4' fill-rule='nonzero'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9zM0 15l12.99-7.5L26 15v18.5l-13 7.5L0 33.5V15z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        /* --- é ‚éƒ¨æ©«å¹…è¨­è¨ˆ (MODIFIED) --- */
        .header {
            background: linear-gradient(to right, #fff5f5, #ffdddd);
            color: var(--text-dark); /* Changed for readability on light background */
            padding: 30px 5%;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); /* Softened shadow */
            border-bottom: 4px solid var(--primary-color);
        }

        .title-container {
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: center;
        }

        .logo {
            width: 60px;
            height: auto;
        }

        .header h1 {
            font-size: 2.5rem;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1); /* Softened shadow */
            margin: 0;
            color: var(--primary-color); /* Ensured title color is primary red */
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .back-button {
            display: inline-block;
            padding: 12px 25px;
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            border: none;
            cursor: pointer;
            background: var(--secondary-color);
        }

        .back-button:hover {
            transform: translateY(-3px);
            background: #06c284;
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.4);
        }
        
        /* --- å…¨å¯¬å…§å®¹å€å¡Š --- */
        .analysis-section {
            background: var(--bg-white);
            margin: 20px auto;
            padding: 30px 5%; /* Responsive padding */
            max-width: 1600px; /* Optional: to prevent it being too wide on very large screens */
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            border-radius: 12px;
            overflow: hidden;
        }
        
        .analysis-section:nth-of-type(even) {
            background: var(--bg-light);
        }

        .section-title {
            font-size: 1.8rem;
            color: var(--text-dark);
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        /* --- é€šç”¨å…ƒä»¶æ¨£å¼ --- */
        .property-info {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            padding: 12px 18px;
            background: #f8fafc;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            font-weight: 600;
            color: var(--text-light);
        }

        .analysis-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
            background: var(--bg-white);
            border-radius: 8px;
            overflow: hidden;
        }

        .analysis-table th, .analysis-table td {
            border: 1px solid var(--border-color);
            padding: 12px 10px;
            text-align: center;
            vertical-align: middle;
        }

        .analysis-table th {
            background-color: #f1f5f9;
            font-weight: 600;
        }
        
        .analysis-table .sub-header {
            background-color: #f8fafc;
            font-size: 12px;
        }

        .analysis-table .zone-cell {
            background-color: #fee2e2;
            color: #b91c1c;
            font-weight: bold;
        }
        
        .analysis-table .subtotal-row td {
            background-color: #fefce8;
            font-weight: bold;
        }

        .gis-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
        }

        .streetview-container {
            height: 500px;
            border-radius: 12px;
            overflow: hidden;
            background: var(--border-color);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .gis-card {
            background: var(--bg-white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        
        .gis-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .gis-card h3 {
            color: var(--secondary-color);
            margin-bottom: 15px;
            font-size: 1.2rem;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .open-map-btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }
        
        .open-map-btn:hover {
            filter: brightness(1.1);
        }
        
        .real-price-table th {
            background-color: var(--secondary-color);
            color: white;
        }
        .real-price-table .price-highlight {
            font-weight: bold;
            color: #c62828;
        }

        .real-price-table tbody tr:hover {
            background-color: #e0f2f1;
        }
        
        .map-container { height: 400px; border-radius: 8px; overflow: hidden; background: #e2e8f0; }
        .streetview-section .streetview-container { margin-top: 20px; }

        /* --- éŸ¿æ‡‰å¼èª¿æ•´ --- */
        @media (max-width: 768px) {
            body { padding: 0; }
            .header { padding: 20px; }
            .header h1 { font-size: 1.8rem; }
            .logo { width: 45px; }
            .analysis-section { padding: 20px 15px; margin-bottom: 10px; border-radius: 0; }
            .section-title { font-size: 1.5rem; }
            .gis-grid { grid-template-columns: 1fr; }
            .analysis-table { font-size: 12px; }
            .analysis-table th, .analysis-table td { padding: 8px 5px; }
            .streetview-container, .map-container { height: 350px; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="title-container">
            <img src="logo.png" alt="ä¸€å¦‚ YIRU Logo" class="logo">
            <h1>ä¸€å¦‚æ°¸çºŒç”¢èª¿åˆ†æè¡¨(åŸºæœ¬ç‰ˆ)</h1>
        </div>
    </header>

    <div class="action-buttons">
        <a href="index.html" class="back-button">â† è¿”å›çœ‹æ¿</a>
    </div>

    <main>
        <section class="analysis-section land-section">
            <h2 class="section-title">ğŸ“œ åœŸåœ°éƒ¨ä»½</h2>
            <div class="property-info">
                <span><strong>åœŸåœ°éƒ¨ä»½</strong></span>
                <span id="landAddress" style="max-width: 70%;"><strong>åœ°æ®µ:è¼‰å…¥ä¸­...</strong></span>
            </div>
            <table class="analysis-table">
                <thead>
                    <tr>
                        <th rowspan="2">åœ°è™Ÿ</th><th rowspan="2">åœŸåœ°<br>åˆ†å€</th><th>å…¬å‘Šç¾å€¼ (114å¹´)</th><th colspan="2">é¢ç©</th><th rowspan="2">æ‰€æœ‰æ¬Š<br>äººæ•¸</th><th colspan="2">åœŸåœ°æŒåˆ†</th><th colspan="3">ä¼ŠåœŸåœ°æŒåˆ†é¢ç©</th><th colspan="1">æœ‰ç„¡åœ°ä¸Šç‰©</th>
                    </tr>
                    <tr class="sub-header">
                        <th>å…ƒ/mÂ²</th><th>mÂ²</th><th>åª</th><th>åˆ†å­</th><th>åˆ†æ¯</th><th>mÂ²</th><th>åª</th><th>æ¯”ä¾‹</th><th>åœ°ä¸Šç‰©å»ºè™Ÿ</th>
                    </tr>
                </thead>
                <tbody id="landTableBody"></tbody>
            </table>
        </section>

        <section class="analysis-section building-section">
            <h2 class="section-title">ğŸ—ï¸ åœ°ä¸Šç‰©éƒ¨ä»½</h2>
            <div class="property-info">
                <span><strong>åœ°ä¸Šç‰©éƒ¨ä»½</strong></span>
                <span id="buildingAddress"><strong>åœ°å€:è¼‰å…¥ä¸­...</strong></span>
            </div>
            <table class="analysis-table">
                <thead>
                    <tr>
                        <th rowspan="2">å»ºè™Ÿ</th><th rowspan="2">æ‰€å«æ¨“<br>å±¤</th><th rowspan="2">å»ºç‰©æ‰€æœ‰æ¬Š<br>äººæ•¸</th><th colspan="2">å»ºç‰©é¢ç©</th><th colspan="2">å»ºç‰©æŒåˆ†</th><th colspan="3">å»ºç‰©æŒåˆ†é¢ç©</th><th rowspan="2">å‚™è¨»</th>
                    </tr>
                    <tr class="sub-header">
                        <th>mÂ²</th><th>åª</th><th>åˆ†å­</th><th>åˆ†æ¯</th><th>mÂ²</th><th>åª</th><th>æ¯”ä¾‹</th>
                    </tr>
                </thead>
                <tbody id="buildingTableBody"></tbody>
            </table>
        </section>

        <section class="analysis-section gis-section">
            <h2 class="section-title">ğŸ—ºï¸ GIS åœ–è³‡å±•ç¤º</h2>
            <div class="gis-grid">
                <div class="gis-card"><h3><span>åœŸåœ°ä½¿ç”¨åˆ†å€åœ–</span><button class="open-map-btn" onclick="openExternalMap('zoning')">æ”¾å¤§åœ°åœ–</button></h3><div class="map-container" id="zoningMap"></div></div>
                <div class="gis-card"><h3><span>åœ°ç±åœ–</span><button class="open-map-btn" onclick="openExternalMap('cadastral')">æ”¾å¤§åœ°åœ–</button></h3><div class="map-container" id="cadastralMap"></div></div>
                <div class="gis-card"><h3><span>åœ°å½¢åœ–</span><button class="open-map-btn" onclick="openExternalMap('topographic')">æ”¾å¤§åœ°åœ–</button></h3><div class="map-container" id="topographicMap"></div></div>
                <div class="gis-card"><h3><span>èˆªç…§åœ–</span><button class="open-map-btn" onclick="openExternalMap('aerial')">æ”¾å¤§åœ°åœ–</button></h3><div class="map-container" id="aerialMap"></div></div>
            </div>
        </section>

        <section class="analysis-section streetview-section">
            <h2 class="section-title">ğŸ“¸ Google è¡—æ™¯åœ–</h2>
            <div class="streetview-container" id="streetviewContainer"></div>
        </section>

        <section class="analysis-section real-price-section">
            <h2 class="section-title">ğŸ’° é„°è¿‘å¯¦åƒ¹ç™»éŒ„è³‡è¨Š</h2>
            <table class="analysis-table real-price-table">
                <thead>
                    <tr>
                        <th>äº¤æ˜“æ™‚é–“</th><th>åœ°å€/åœ°æ®µ</th><th>å‹æ…‹</th><th>ç¸½åƒ¹</th><th>åœŸåœ°åªæ•¸</th><th>å–®åƒ¹</th><th>å‚™è¨»</th>
                    </tr>
                </thead>
                <tbody id="realPriceTableBody"></tbody>
            </table>
        </section>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <script>
        const PING_TO_M2 = 3.305785;
        let currentCoords = [25.0330, 121.5654];
        
        function getLandData() {
            const storedData = sessionStorage.getItem('selectedLand');
            let baseData = {};
            if (storedData) {
                baseData = JSON.parse(storedData);
            }
            const defaults = {
                id: new URLSearchParams(window.location.search).get('landId') || Math.floor(Math.random() * 100) + 1,
                title: "é«˜é›„å¸‚é¼“å±±å€è¾²åœ°3åœ°è™Ÿ",
                region: "é«˜é›„å¸‚", district: "é¼“å±±å€", area: 60.19, pricePerPing: 130.5,
                landUseZone: ["ä½å®…å€", "å•†æ¥­å€", "å·¥æ¥­ä¸€", "è¾²æ¥­å€", "ä¿è­·å€"][Math.floor(Math.random() * 5)],
                ownerCount: Math.floor(Math.random() * 15) + 2,
                shareNumerator: 1, shareDenominator: Math.floor(Math.random() * 15) + 5,
                marketPrice: Math.floor(Math.random() * 50) + 80
            };
            const finalData = { ...defaults, ...baseData };
            finalData.shareNumerator = Math.min(finalData.shareNumerator, finalData.shareDenominator);
            return finalData;
        }

        function renderLandTable(land) {
            const areaM2 = land.area * PING_TO_M2;
            const announcedValuePerM2 = Math.round(land.marketPrice * 10000 / PING_TO_M2);
            const shareRatio = land.shareDenominator > 0 ? (land.shareNumerator / land.shareDenominator) : 0;
            const shareAreaM2 = areaM2 * shareRatio;
            const shareAreaPing = land.area * shareRatio;
            const sharePercentage = (shareRatio * 100).toFixed(2);
            const buildingDisplay = land.hasBuilding ? land.buildingId : 'ç„¡';
            const announcedValueDisplay = announcedValuePerM2 > 0 ? announcedValuePerM2.toLocaleString() : 'éæ•¸å€¼';
            document.getElementById('landAddress').innerHTML = `<strong>åœ°æ®µ:${land.title}</strong>`;
            document.getElementById('landTableBody').innerHTML = `<tr><td>${land.id}</td><td class="zone-cell">${land.landUseZone}</td><td>${announcedValueDisplay}</td><td>${areaM2.toFixed(2)}</td><td>${land.area.toFixed(2)}</td><td>${land.ownerCount}</td><td>${land.shareNumerator}</td><td>${land.shareDenominator}</td><td>${shareAreaM2.toFixed(2)}</td><td>${shareAreaPing.toFixed(2)}</td><td>${sharePercentage}%</td><td>${buildingDisplay}</td></tr><tr class="subtotal-row"><td colspan="3">å°è¨ˆ</td><td>${areaM2.toFixed(2)}</td><td>${land.area.toFixed(2)}</td><td colspan="3"></td><td>${shareAreaM2.toFixed(2)}</td><td>${shareAreaPing.toFixed(2)}</td><td>${sharePercentage}%</td><td></td></tr>`;
        }
        
        function renderBuildingTable(land) {
            if (!land.hasBuilding) {
                document.getElementById('buildingAddress').innerHTML = `<strong>åœ°å€: ç„¡</strong>`;
                document.getElementById('buildingTableBody').innerHTML = `<tr><td colspan="11" style="text-align: center; padding: 20px; color: #666;">æ­¤ç­†åœŸåœ°ç„¡åœ°ä¸Šç‰©</td></tr>`;
                return;
            }
            const streets = ["ä¸­æ­£è·¯", "ä¸­å±±è·¯", "æˆåŠŸè·¯", "å¤§æ¥­è·¯", "å’Œå¹³è·¯", "å»ºåœ‹è·¯", "å»£ç¦è·¯"];
            const randomStreet = streets[Math.floor(Math.random() * streets.length)];
            const fullAddress = `${land.region}${land.district}${randomStreet}${Math.floor(Math.random() * 100) + 1}å··${Math.floor(Math.random() * 200) + 1}è™Ÿ`;
            document.getElementById('buildingAddress').innerHTML = `<strong>åœ°å€: ${fullAddress}</strong>`;
            const buildingOwners = Math.floor(Math.random() * 15) + 1;
            const buildingShareRatio = land.shareDenominator > 0 ? (land.shareNumerator / land.shareDenominator) : 0;
            const totalFloors = Math.floor(Math.random() * 3) + 1;
            let totalBuildingAreaM2 = 0, totalShareAreaM2 = 0, tableRowsHTML = '';
            for(let i = 1; i <= totalFloors; i++) {
                const floorAreaPing = (Math.random() * 15 + 10).toFixed(2), floorAreaM2 = (floorAreaPing * PING_TO_M2), floorShareAreaM2 = (floorAreaM2 * buildingShareRatio), floorShareAreaPing = (floorAreaPing * buildingShareRatio);
                totalBuildingAreaM2 += floorAreaM2; totalShareAreaM2 += floorShareAreaM2;
                tableRowsHTML += `<tr>${i===1?`<td rowspan="${totalFloors}">${land.buildingId}</td>`:''}<td>${i}</td>${i===1?`<td rowspan="${totalFloors}">${buildingOwners}</td>`:''}<td>${floorAreaM2.toFixed(2)}</td><td>${floorAreaPing}</td><td>${land.shareNumerator}</td><td>${land.shareDenominator}</td><td>${floorShareAreaM2.toFixed(2)}</td><td>${floorShareAreaPing.toFixed(2)}</td><td>${(buildingShareRatio * 100).toFixed(2)}%</td>${i===1?`<td rowspan="${totalFloors}"></td>`:''}</tr>`;
            }
            const totalBuildingAreaPing = (totalBuildingAreaM2 / PING_TO_M2).toFixed(2), totalShareAreaPing = (totalShareAreaM2 / PING_TO_M2).toFixed(2), totalSharePercentage = ((buildingShareRatio * 100) * totalFloors).toFixed(2);
            document.getElementById('buildingTableBody').innerHTML = tableRowsHTML + `<tr class="subtotal-row"><td colspan="3">å°è¨ˆ</td><td>${totalBuildingAreaM2.toFixed(2)}</td><td>${totalBuildingAreaPing}</td><td colspan="2"></td><td>${totalShareAreaM2.toFixed(2)}</td><td>${totalShareAreaPing}</td><td>${totalSharePercentage}%</td><td></td></tr>`;
        }
        
        function renderRealPriceTable(land) {
            let contentHTML = '';
            for (let i = 0; i < 8; i++) {
                const transactionDate = `114/${String(Math.floor(Math.random()*5)+1).padStart(2,'0')}`;
                const address = `${land.district}${[ "ä¸­æ­£è·¯", "ä¸­å±±è·¯", "æˆåŠŸè·¯", "å¤§æ¥­è·¯"][Math.floor(Math.random()*4)]}${Math.floor(Math.random()*200)+1}è™Ÿ`;
                const type = ["ä½å®…ç”¨åœ°/å»º", "å•†æ¥­ç”¨åœ°/å•†", "å·¥æ¥­ç”¨åœ°/å·¥"][Math.floor(Math.random()*3)];
                const area = land.area*(1+(Math.random()-.5)*.8), unitPrice = land.pricePerPing*(1+(Math.random()-.5)*.6), totalPrice = area*unitPrice;
                contentHTML += `<tr><td style="text-align:center;">${transactionDate}</td><td>${address}</td><td style="text-align:center;">${type}</td><td style="text-align:center;" class="price-highlight">${(totalPrice/1e4).toFixed(1)} å„„</td><td style="text-align:center;">${area.toFixed(2)} åª</td><td style="text-align:center;" class="price-highlight">${unitPrice.toFixed(1)} è¬/åª</td><td style="text-align:center;">${Math.random()>.85?"è¦ªå‹äº¤æ˜“":""}</td></tr>`;
            }
            document.getElementById('realPriceTableBody').innerHTML = contentHTML;
        }

        function initializeMaps(land) {
            let coords = [25.0330, 121.5654];
            if (land.region === "æ¡ƒåœ’å¸‚") coords = [24.9936, 121.3010]; else if (land.region === "å°ä¸­å¸‚") coords = [24.1477, 120.6736]; else if (land.region === "å°å—å¸‚") coords = [22.9997, 120.2270]; else if (land.region === "é«˜é›„å¸‚") coords = [22.6273, 120.3014];
            currentCoords = coords;
            const zoningMap = L.map('zoningMap').setView(coords,16); L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(zoningMap); L.polygon([[coords[0]+.001,coords[1]-.001],[coords[0]+.001,coords[1]+.001],[coords[0]-.001,coords[1]+.001],[coords[0]-.001,coords[1]-.001]],{color:'#DC2626',fillColor:'#ffcdd2',fillOpacity:.5}).addTo(zoningMap).bindPopup(`ä½¿ç”¨åˆ†å€:${land.landUseZone}`);
            const cadastralMap = L.map('cadastralMap').setView(coords,17); L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(cadastralMap); L.marker(coords).addTo(cadastralMap).bindPopup(`åœ°è™Ÿ:${land.id}`); L.polygon([[coords[0]+.0008,coords[1]-.0008],[coords[0]+.0008,coords[1]+.0008],[coords[0]-.0008,coords[1]+.0008],[coords[0]-.0008,coords[1]-.0008]],{color:'#2563eb',weight:2,fillOpacity:.1}).addTo(cadastralMap);
            const topographicMap = L.map('topographicMap').setView(coords,15); L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png').addTo(topographicMap); L.marker(coords).addTo(topographicMap).bindPopup(`åœ°å½¢ä½ç½®`);
            const aerialMap = L.map('aerialMap').setView(coords,18); L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}').addTo(aerialMap); L.circle(coords,{color:'#059669',fillColor:'#10b981',fillOpacity:.3,radius:50}).addTo(aerialMap).bindPopup('åœŸåœ°ä½ç½®');
            setTimeout(() => { zoningMap.invalidateSize(); cadastralMap.invalidateSize(); topographicMap.invalidateSize(); aerialMap.invalidateSize(); }, 200);
        }

        function initializeStreetView(land) {
            let coords = currentCoords;
            const streetviewMap = L.map('streetviewContainer').setView(coords, 18); L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}').addTo(streetviewMap);
            const marker = L.marker(coords).addTo(streetviewMap); const streetviewUrl = `https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${coords[0]},${coords[1]}`;
            marker.bindPopup(`<div style="text-align:center;"><strong>${land.title}</strong><br><a href="${streetviewUrl}" target="_blank" style="display:inline-block;margin-top:10px;padding:8px 16px;background:linear-gradient(135deg, #4285f4 0%, #34a853 100%);color:white;text-decoration:none;border-radius:6px;font-weight:600;">ğŸŒ é–‹å•Ÿ Google è¡—æ™¯</a></div>`).openPopup();
            setTimeout(() => { streetviewMap.invalidateSize(); }, 200);
        }

        function openExternalMap(mapType) {
            let url = `https://www.openstreetmap.org/#map=17/${currentCoords[0]}/${currentCoords[1]}`;
            if (mapType === 'aerial') url = `https://www.google.com/maps/@${currentCoords[0]},${currentCoords[1]},18z/data=!3m1!1e3`;
            window.open(url, '_blank');
        }

        document.addEventListener('DOMContentLoaded', function() {
            const land = getLandData();
            land.hasBuilding = Math.random() > 0.2;
            if (land.hasBuilding) {
                land.buildingId = Math.floor(Math.random() * 5000) + 10000;
            }
            renderLandTable(land); 
            renderBuildingTable(land); 
            renderRealPriceTable(land);
            initializeMaps(land); 
            initializeStreetView(land); 
        });
    </script>
</body>
</html>